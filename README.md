# Car Detection and Classification Pipeline

## Pipeline

## Overview

This repository contains code for a car detection and classification pipeline.
The pipeline is divided into four parts:

1. Data Processing: This part of the pipeline involves preprocessing the raw data
and preparing it for modeling. It includes data cleaning, feature engineering, 
and data transformation.
2. Modeling: This part of the pipeline involves training a deep learning model
on the preprocessed data to detect and classify cars in images.
The model is based on PyTorch and Pytorch-Lightning.
3. Pruning: This part of the pipeline involves pruning the trained model
to reduce its size and complexity while maintaining accuracy. 
4. Deployment: This part of the pipeline involves deploying the pruned model
in a production environment to make predictions on new images.

All codes except deployment code is located under the src directory.

### Data Processing

The data processing code is located in the `src/dataprocess` directory.
The code in this directory includes scripts for data cleaning, feature
engineering, and data transformation.

The data processing pipeline takes raw images and annotations as input and
outputs preprocessed data in a format suitable for training the model.

### Modeling

The modeling code is located in the `src/nn` directory. The code in this directory
includes the PyTorch code for the car detection and classification model.
The model is trained on the preprocessed data generated by the data processing pipeline.
The trained model is saved in a format suitable for deployment.

### Pruning

The pruning code is located in the `src/pruning` directory. The code in this
directory includes scripts for pruning the trained model to reduce its
size and complexity while maintaining accuracy.

The pruned model is saved in a format suitable for deployment.

### Deployment

The deployment code is located in the `deploy` directory.
The code in this directory includes scripts for loading the pruned model and using it to make predictions on new images.
The code in this directory can be used to deploy the model in a production environment.

The code is written in Pytorch and uses both Lightning and FastAPI.

- for lightning app: `deploy/lightning`
- for pure fastAPI app: `deploy/fastapi`

## Getting Started

To get started with the car detection and classification pipeline, clone this repository to your local machine and install the required dependencies using the requirements.txt file. The code in this repository has been tested on Python 3.10.

```bash
Copy code
git clone https://github.com/Klassikcat/Car-Detection-in-video.git
cd Car-Detection-in-video
pip install -r requirements.txt
```

Once you have installed the required dependencies, you can run each part of the pipeline separately or run the entire pipeline using the main script run_pipeline.py.

### Train

```bash
python train.py
```

### Prune

```bash
python prune.py
```

### Deploy

```bash
lightning run app deploy/lightning/app.py # for lightningapp run
```

## Contributors

- Shin Jung Tae(@Klassikcat)

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Annotation

This repository's README is written by [chatGPT](https://chat.openai.com)